import './polyfills.server.mjs';
import{b as P,c as w,d as O,e as S,f as k,g as R,k as I,n as E}from"./chunk-NDVIAY2Q.mjs";import{Cb as D,I as A,Ib as y,J as g,Kb as v,M as u,O as h,S as _,Z as c,_ as j,da as n,e as W,ea as r,fa as z,h as F,k as q,ka as f,la as b,lb as M,qb as x,ta as s,ua as L,va as B,xa as m,ya as p,za as d}from"./chunk-OCSTSHTI.mjs";import"./chunk-X2SEQXRR.mjs";var C=class i{constructor(o){this.http=o}apiUrl="http://localhost:5000/auth";register(o,t){return this.http.post(`${this.apiUrl}/register`,{username:o,password:t})}login(o,t,e){return this.http.post(`${this.apiUrl}/login`,{username:o,password:t,otp:e}).pipe(W(l=>{l.token&&localStorage.setItem("token",l.token)}))}validateToken(o){return this.http.post(`${this.apiUrl}/validate_token`,{token:o})}static \u0275fac=function(t){return new(t||i)(q(D))};static \u0275prov=F({token:i,factory:i.\u0275fac,providedIn:"root"})};function J(i,o){if(i&1&&(n(0,"div",9),s(1),r()),i&2){let t=b();g(),B(" ",t.error," ")}}var T=class i{constructor(o,t){this.authService=o;this.router=t}username="";password="";otp="";error="";onSubmit(){this.authService.login(this.username,this.password,this.otp).subscribe({next:o=>{o?.token?(localStorage.setItem("token",o.token),this.error="",this.router.navigate(["/tasks"])):this.error="No se recibi\xF3 un token v\xE1lido"},error:()=>{this.error="Credenciales u OTP incorrectos",localStorage.removeItem("token")}})}goToRegister(){this.router.navigate(["/auth/register"])}static \u0275fac=function(t){return new(t||i)(u(C),u(y))};static \u0275cmp=h({type:i,selectors:[["app-login"]],decls:22,vars:4,consts:[[1,"login-container"],[3,"submit"],["type","text","name","username","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["type","text","name","otp","required","",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],["type","submit"],[1,"register-link"],[3,"click"],[1,"error-message"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"h2"),s(2,"Iniciar Sesi\xF3n"),r(),n(3,"form",1),f("submit",function(a){return e.onSubmit(),a.preventDefault()}),n(4,"div")(5,"label"),s(6,"Usuario"),r(),n(7,"input",2),d("ngModelChange",function(a){return p(e.username,a)||(e.username=a),a}),r()(),n(8,"div")(9,"label"),s(10,"Contrase\xF1a"),r(),n(11,"input",3),d("ngModelChange",function(a){return p(e.password,a)||(e.password=a),a}),r()(),n(12,"div")(13,"label"),s(14,"OTP (Google Authenticator)"),r(),n(15,"input",4),d("ngModelChange",function(a){return p(e.otp,a)||(e.otp=a),a}),r()(),_(16,J,2,1,"div",5),n(17,"button",6),s(18,"Entrar"),r()(),n(19,"div",7)(20,"button",8),f("click",function(){return e.goToRegister()}),s(21,"\xBFNo tienes una cuenta? Reg\xEDstrate aqu\xED"),r()()()),t&2&&(g(7),m("ngModel",e.username),g(4),m("ngModel",e.password),g(4),m("ngModel",e.otp),g(),c("ngIf",e.error))},dependencies:[x,M,E,R,P,w,O,I,k,S,v],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{margin:0;padding:0;height:100%;display:flex;justify-content:center!important;align-items:center;background:linear-gradient(to right,#012,#036,#001a4d)!important;font-family:Arial,sans-serif}.login-container[_ngcontent-%COMP%]{background-color:#fff;padding:30px 40px;border-radius:12px;box-shadow:0 0 20px #003366b3;width:100%;max-width:400px;box-sizing:border-box;justify-content:center!important}.login-container[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px;color:#036}.login-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:700;color:#222}.login-container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .login-container[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:18px;border:1px solid #004080;border-radius:8px;font-size:14px}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#036;color:#fff;border:none;border-radius:8px;font-size:16px;cursor:pointer;transition:background-color .3s ease}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#001f4d}.login-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;margin-bottom:10px;font-size:14px;text-align:center}.login-container[_ngcontent-%COMP%]   .register-button[_ngcontent-%COMP%]{background:none;border:none;color:#036;font-weight:700;text-decoration:underline;cursor:pointer;margin-top:15px;display:block;margin-left:auto;margin-right:auto;font-size:14px}.error-message[_ngcontent-%COMP%]{color:red;margin-top:.5rem}.token-box[_ngcontent-%COMP%]{background:#eee;padding:1rem;margin-top:1rem;word-break:break-all}.register-link[_ngcontent-%COMP%]{text-align:center;margin-top:1rem}.register-link[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#007bff;font-weight:700;text-decoration:underline;cursor:pointer}"]})};function K(i,o){if(i&1&&(n(0,"div",10),s(1),r()),i&2){let t=b();g(),L(t.error)}}function X(i,o){if(i&1&&(n(0,"div",11),s(1),r()),i&2){let t=b();g(),L(t.success)}}function Z(i,o){if(i&1&&(n(0,"div",12)(1,"p"),s(2,"Escanea este c\xF3digo QR con Google Authenticator:"),r(),z(3,"img",13),r()),i&2){let t=b();g(3),c("src","data:image/png;base64,"+t.qrCodeBase64,A)}}var N=class i{constructor(o,t){this.authService=o;this.router=t}username="";password="";error="";success="";qrCodeBase64="";onSubmit(){if(!this.username||!this.password){this.error="Por favor completa todos los campos",this.success="";return}this.authService.register(this.username,this.password).subscribe({next:o=>{this.success="Registro exitoso. Escanea el c\xF3digo QR con Google Authenticator.",this.qrCodeBase64=o.qr_code_base64,this.error=""},error:o=>{this.error="No se pudo registrar. Intenta con otro usuario.",this.success=""}})}goToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||i)(u(C),u(y))};static \u0275cmp=h({type:i,selectors:[["app-register"]],decls:20,vars:10,consts:[[1,"login-container"],["style","color: red; margin-bottom: 1rem;",4,"ngIf"],["style","color: green; margin-bottom: 1rem;",4,"ngIf"],[3,"ngSubmit"],["type","text","name","username","required","",3,"ngModelChange","ngModel"],["type","password","name","password","required","",3,"ngModelChange","ngModel"],["type","submit",3,"disabled"],["style","margin-top: 1rem;",4,"ngIf"],[2,"text-align","center","margin-top","1rem"],[2,"background","none","border","none","color","#fff","font-weight","bold","text-decoration","underline","cursor","pointer",3,"click"],[2,"color","red","margin-bottom","1rem"],[2,"color","green","margin-bottom","1rem"],[2,"margin-top","1rem"],["alt","QR Code",3,"src"]],template:function(t,e){t&1&&(n(0,"div",0)(1,"h2"),s(2,"Crear Cuenta"),r(),_(3,K,2,1,"div",1)(4,X,2,1,"div",2),n(5,"form",3),f("ngSubmit",function(){return e.onSubmit()}),n(6,"div")(7,"label"),s(8,"Usuario"),r(),n(9,"input",4),d("ngModelChange",function(a){return p(e.username,a)||(e.username=a),a}),r()(),n(10,"div")(11,"label"),s(12,"Contrase\xF1a"),r(),n(13,"input",5),d("ngModelChange",function(a){return p(e.password,a)||(e.password=a),a}),r()(),n(14,"button",6),s(15," Registrarse "),r()(),_(16,Z,4,1,"div",7),n(17,"div",8)(18,"button",9),f("click",function(){return e.goToLogin()}),s(19," \xBFYa tienes cuenta? Inicia sesi\xF3n "),r()()()),t&2&&(g(3),c("ngIf",e.error),g(),c("ngIf",e.success),g(5),m("ngModel",e.username),g(4),m("ngModel",e.password),g(),j("opacity",!e.username||!e.password?"0.5":"1")("cursor",!e.username||!e.password?"not-allowed":"pointer"),c("disabled",!e.username||!e.password),g(2),c("ngIf",e.qrCodeBase64))},dependencies:[x,M,E,R,P,w,O,I,k,S,v],styles:["body[_ngcontent-%COMP%], html[_ngcontent-%COMP%]{margin:0;padding:0;height:100%;display:flex;justify-content:center!important;align-items:center;background:linear-gradient(to right,#012,#036,#001a4d)!important;font-family:Arial,sans-serif}.login-container[_ngcontent-%COMP%]{background-color:#fff;padding:30px 40px;border-radius:12px;box-shadow:0 0 20px #003366b3;width:100%;max-width:400px;box-sizing:border-box;justify-content:center!important}.login-container[_ngcontent-%COMP%]:hover{transform:scale(1.02)}.login-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px;color:#036}.login-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:700;color:#222}.login-container[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .login-container[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:18px;border:1px solid #004080;border-radius:8px;font-size:14px}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{width:100%;padding:12px;background-color:#036;color:#fff;border:none;border-radius:8px;font-size:16px;cursor:pointer;transition:background-color .3s ease}.login-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#001f4d}.login-container[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{color:red;margin-bottom:10px;font-size:14px;text-align:center}.login-container[_ngcontent-%COMP%]   .register-button[_ngcontent-%COMP%]{background:none;border:none;color:#036;font-weight:700;text-decoration:underline;cursor:pointer;margin-top:15px;display:block;margin-left:auto;margin-right:auto;font-size:14px}.error-message[_ngcontent-%COMP%]{color:red;margin-top:.5rem}.token-box[_ngcontent-%COMP%]{background:#eee;padding:1rem;margin-top:1rem;word-break:break-all}.register-link[_ngcontent-%COMP%]{text-align:center;margin-top:1rem}.register-link[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;color:#007bff;font-weight:700;text-decoration:underline;cursor:pointer}"]})};var de=[{path:"login",component:T},{path:"register",component:N}];export{de as authRoutes};
